#!/usr/bin/python3
#scanner.py

import socket
import time
import sys

if len(sys.argv) != 4:
    print("[!] This script works with the IP, starting port and end port respectively as parameters.")
    exit(1)

startTime = time.time() #Este parámetro recoge el tiempo actual.
target = sys.argv[1] #Este parámetro asocia a la variable target el primer parámtero con el que se pasa el stream.
target_IP = socket.gethostbyname(target)
print ('[+] Initiating Scan for host: ', target_IP)
     
for i in range(int(sys.argv[2]), int(sys.argv[3])): #Se toma para el escaneo los números pasados como segundo y tercer parámetros del script.
    scanner = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    conn = scanner.connect_ex((target_IP, i)) #Empleamos el connext_ex() method para interpretar a partir del código de error del mismo el estado del puerto escaneado.
    if(conn == 0):
        print ('[+] -> Port %d: OPEN' %(i))#El %d expone la variable indicada con posterioridad en decimal.
    scanner.close()

endTime = time.time()#Guardamos en la variable endtime el tiempo transcurrido y lo restamos al startTime para obtener el tiempo de duración del scaner.
totalTime = endTime - startTime
print('[+] Total Time: %s' %(totalTime))
